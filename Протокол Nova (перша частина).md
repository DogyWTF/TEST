<!-- ПРОТОКОЛ "Nova" Ver.3 -->


# <center>ПРОТОКОЛ "Nova" Ver.3</center>  
**1\. Опис протоколу.  
1.1  Загальні відомості**

**1.1.1 Сеанс зв'язку в CSD з ініціативи ППК (зміна стану, тести зв'язку)**  
`{CSD не реалізовано!}`
![alt](./photo1.png)  


**1.1.2 Сеанс зв'язку в CSD з ініціативи ПЦС (команди)**  
`{CSD не реалізовано!}`
![alt](./photo2.png)  


**1.1.3 Безоплатний тест зв'язку в голосовому каналі**  
`{CSD не реалізовано!}`
![alt](./photo3.png)  


**1.1.4 Сеанс зв'язку в GPRS або Ethernet з ініціативи ППК (зміна стану, тести зв'язку)**  
![alt](./photo4.png)  


**1.1.5 Сеанс зв'язку в GPRS або Ethernet з ініціативи ПЦС (команди)**  
![alt](./photo5.png)  


<!-- Структура пакета «Nova». -->


## 1.2 Структура пакета «Nova».

1.2.1 Загальний формат пакетів від ПЦС або ППК відрізняються тільки значенням поля SYNH.  
1.2.2 Поля DAT мають змінну довжину, залежно від типу пакета.  
1.2.3 Максимальна довжина пакета (від SYNH до CRC8) - 509 байтів.  

<!-- Таблиця 1.1 -->
<p id="table1-1"><b>Таблиця 1.1</b> - Структура пакетів «Nova»</p>

|Поле|Довжина, байт|Опис|
|---|---|---|
|SYNH|1|0x9С - напрямок від ППК на ПЦС <br/> 0xС9- напрямок від ПЦС до ППК|
|SER_ID|4|Заводський серійний номер|
|PROT_VER|1|Версія протоколу|
|CRYPT_TYPE|1|Метод шифрування: <br/> 0x00 - без шифрування; <br/> 0x01 - DES; <br/> 0x02 - AES128; <br/> 0x03 - AES128 з використанням статичного ключа;|
|PATH|1|Канал зв'язку, формат **0xAB**: <br/> **A** – фізичний канал: 0 - SIM1, 1 - SIM2, 2 - Ethernet, 3 - WiFi; <br/> **B** – номер сокета ПЦС (порядок перебору під час спроби передавання);|
|PACK_ID|1|Ідентифікатор пакета (0х01h-0хFFh). Лічильник номера поточного пакета, формується приладом. Може бути використаний для видалення підтверджених повідомлень.|
|PCN_ID|1|Ідентифікатор пакета (0х01h-0хFFh). Лічильник номера поточного пакета, формується пультом, згідно з пунктом 4|
|LEN|2|0x0A ... 0x1F6 - довжина блоку даних DAT0... DATxxx (без урахування CRC8).|
|DAT0.. DAT499|0.. 499|Блок даних, до якого можуть входити будь-які дані, як-от повідомлення, дані журналу, налаштування, ідентифікатори версії ПЗ тощо.|
|CRC8|1|Поліном Dallas/Maxim: X8+X5+X4+1 (0x31/0x8C/0x98). Застосовується виключно для блоку даних|

*Примітки:*
1. *Хоча транспортний рівень TCP або UDP має свою контрольну суму CRC, CRC8 у пакеті "Nova" використовується для перевірки правильності розшифрування даних.*
2. *У пакетах усі поля довжиною більше одного байта формуються у форматі **Little-endian**: BYTEL ... BYTEH.*
3. *Загальна довжина блоку PACK_ID ... CRC8 пакета після шифрування не повинна бути більше 504 байтів.*

**1.3 Шифрування**  

**Доповнення блоків**  

**Шифрування пакета**

<!-- Ідентифікатор пакета -->
**1.4 Ідентифікатор пакета**
	
Формування ідентифікатора пакета здійснюється таким чином.
  - За генерацію **PCN_ID** відповідає **ТІЛЬКИ** ПЦС.
  - За генерацію **PACK_ID** відповідає **ТІЛЬКИ** об'єктовий пристрій.
  - Об'єктовий пристрій (ППК, ПСО) під час формування події генерує **PACK_ID**. Значення **PCN_ID** береться з попереднього сеансу зв'язку з пультом, для кожного сокета ПЦС окремо (значення **B** у полі  PATH Табл.1.1) . Якщо попереднього сеансу зв'язку не було (перше увімкнення), **PCN_ID** від приладу встановлюється рівним 0 (або, якщо прилад зберігає значення в енергонезалежній пам'яті, береться з енергонезалежної пам'яті).
  - У разі штатного знеструмлення (розряд батареї внаслідок відсутності основного живлення) об'єктовий пристрій має зберегти **PACK_ID** в енергонезалежній пам'яті перед відключенням від батареї, якщо це передбачено конструкцією.
  - Під час увімкнення після повного знеструмлення об'єктовий пристрій починає сеанс із **PACK_ID** = 1.

<!-- Процедура обробки вхідних пакетів пультом -->
**1.5  Процедура обробки вхідних пакетів пультом.**

Якщо пульт не зміг розшифрувати вхідний пакет (DEV_ID вхідного пакета в базі є), пульт формує в журнал повідомлення **"Розбіжність ключа шифрування"**.
	
Якщо пульт розшифрував вхідний пакет коректно:
  1. `Нормальний обмін`. Якщо в прийнятому пакеті **PCN_ID** збігається **зі збереженим на** пульті значенням, пульт **<u>обробляє пакет</u>**, генерує і зберігає новий **PCN_ID** (1-255), і надсилає його в підтвердженні (**ACK**). Виняток - див. `"Повтор пакета"`.
  2. `Збій ідентифікатора пакета.` Якщо **PCN_ID** не збігається, необхідно, **<u>не обробляючи прийнятий пакет</u>**, надіслати команду **"Запит на повтор пакета"** з новим **PCN_ID**. Якщо відповідь від об'єктового пристрою повернута з **PCN_ID**, що відповідає запиту, прийнятий пакет відправляється в обробку. В іншому випадку, процедура може бути повторена багаторазово (певну кількість разів, або до закінчення часу тесту з приладом, якщо він не великий). Починаючи з Rev.12 протоколу введено команду [0x0А22 - Запит ідентифікації пристрою.](http) У разі розбіжності **PCN_ID** можна надіслати команду 0х0А22 для перевірки достовірності пристрою (пристрій має повернути для звірки прихований ідентифікатор, який має бути збережено (збережено) на пульті під час налаштування об'єкта).  
  Детальний опис алгоритму опрацювання ідентифікатора пакета і визначення підміни пультом (з урахуванням різних версій ПЗ), показано в **Додатку А.**  
  3. `Повтор пакета.` Пульт має зберігати останнє отримане значення **PACK_ID** від пристрою.  Якщо в прийнятому пакеті **PACK_ID** збігається зі збереженим раніше значенням (з попереднього приймання), це повтор пакета. На повтор пакета потрібно відповісти, але без зміни **PCN_ID**.


<!-- Можливість автоматичного підстроювання інтервалу контролю тестових повідомлень пультом -->
**1.6  Можливість автоматичного підстроювання інтервалу контролю тестових повідомлень пультом.**

Починаючи з REV.12 протоколу, прилад у пакеті **TEST_EVENT** ("Повідомлення "Тест") передає значення інтервалу тесту **TEST_TIME** (у секундах), що записано в налаштуваннях приладу.  
Це значення може бути використано пультом для автоматичного налаштування інтервалу часу для контролю зв'язку з приладом. Рекомендоване значення інтервалу часу, який використовується для контролю зв'язку, - **TEST_TIME * 3**.  
**Для визначення підтримки протоколом параметра TEST_TIME (визначення старих версій), потрібно використовувати довжину пакета TEST_EVENT, для версій протоколу без підтримки TEST_TIME вона менша.**
	
**Рекомендації щодо реалізації функції на пульті.**

Зміна раніше збереженого значення TEST_TIME у базах пульта має відбуватися щоразу після отримання таких команд: **0х0303, 0х0304, 0х0301, 0х0307.**

<!-- ПОВІДОМЛЕННЯ ВІД ППК (EVENTS) -->
## 2 ПОВІДОМЛЕННЯ ВІД ППК (EVENTS)

У таблицях наведено тільки формат блоку даних DAT0... DAT499 пакета протоколу "Nova" ([Таблиця 1.1](#table1-1)).

<!-- АВТОМАТИЧНО СФОРМОВАНІ -->
## 2.1 АВТОМАТИЧНО СФОРМОВАНІ

<!-- IDT_EVENT -->
Пакет **IDT_EVENT** — Дані про прилад

|Поле|Назва поля|Довжина, байт|Опис|
|---|---|---|---|
|DAT0 …DAT1|EVENT|2|EVENT - подія/повідомлення від ППК, згідно з табл. 2.1|
|DAT2|PRIORITY|1|Пріоритет повідомлення: 0 - найвищий (тривоги, пожежі), 1..3 - інші|
|DAT3 …DAT6|DEV_ID|4|Ідентифікатор приладу **0xDDHHSSVV**, де: <br/> **DD** – тип приладу; <br/> **HH** – версія "заліза"; <br/> **SS** – версія програмного забезпечення; <br/> **VV** -  ревізія програмного забезпечення.|
|DAT7|DEV_NAME|1... 32|Назва приладу в у форматі рядка ASCII із закінченням рядка.|

*Примітки: Формат підтвердження про приймання від ПЦС — [EVENT_ACK][EVENT_ACK]*

<br/>

<!-- TEST_EVENT -->
Пакет **TEST_EVENT** - Повідомлення «Тест»
|Поле|Назва поля|Довжина, байт|Опис|
|---|---|---|---|
|DAT0 …DAT1|EVENT|2|EVENT – подія/повідомлення від ППК, згідно з табл. 2.1|
|DAT2|PRIORITY|1|Пріоритет повідомлення: 0 - найвищий (тривоги, пожежі), 1..3 - інші|
|DAT3 …DAT6|CHANNEL|4|Тип каналу, яким передано повідомлення <br/> **0xABCD** (4 байти): <br/> **A** – фізичний канал: 0 - SIM1, 1 - SIM2, 2 - Ethernet, 3 - WiFi; <br/> **B** –  технологія: 0 - невідомо, 1 - INET(GPRS), 2 - CSD, 3- SMS, 4 - VOICE, 5 - LAN, 6 - DNS. <br/> **С** – пріоритет каналу (порядок перебору під час спроби передачі):  0 - найвищий (основний), 1 .... 8 - резервні; <br/> **D** – зарезервовано.|
|DAT7|SIGNAL_LEVEL|1|Рівень сигналу GSM модуля: 0x00 ... 0x20|
|DAT8|ERROR_RATE|1|Рівень помилок передавання пакетів, у % від загальної кількості переданих.|
|DAT9 ... DAT10|TEST_TIME|2|Час надсилання повідомлень TEST_EVENT, налаштований у приладі (у секундах).|

*Примітки.*
1. *За наявності повідомлень у буфері на передавання тест не формувати*
2. *Формат підтвердження про приймання від ПЦС — [EVENT_ACK][EVENT_ACK]*

<br/>

<!-- ZONE_EVENT -->
Пакет **ZONE_EVENT** - Повідомлення від зон ППК: "Тривога", "Пожежа", "Передпожежа", "Несправність" і "Вимкнення".

|Поле|Назва поля|Довжина, байт|Опис|
|---|---|---|---|
|DAT0 …DAT1|EVENT|2|EVENT – подія/повідомлення від ППК, згідно з табл. 2.1|
|DAT2|PRIORITY|1|Пріоритет повідомлення: 0 - найвищий (тривоги, пожежі), 1..3 - інші|
|DAT3 …DAT6|DATE/TIME|4|UNIXTIME - час формування повідомлення у форматі UNIX TIME.|
|DAT7 … <br/> <br/> <br/> … DATn|ZONE1 <br/> ZONE2 <br/> … <br/> ZONEn|2 <br/> 2 <br/> <br/> 2| ZONEх - номер зони (шлейфу). <br/> Максимальна кількість полів ZONEх в одному пакеті - 248 (0xF8).|

*Примітка. Формат підтвердження про приймання від ПЦС — [EVENT_ACK][EVENT_ACK]*

<br/>

<!-- ZONE_SENSORS_EVENT -->
Пакет **ZONE_SENSORS_EVENT** - Повідомлення від зон ППК про тривоги сенсорів.

|Поле|Назва поля|Довжина, байт|Опис|
|---|---|---|---|
|DAT0 …DAT1|EVENT|2|EVENT – подія/повідомлення від ППК, згідно з табл. 2.1|
|DAT2|PRIORITY|1|Пріоритет повідомлення: 0 - найвищий (тривоги, пожежі), 1..3 - інші|
|DAT3 …DAT6|DATE/TIME|4|UNIXTIME - час формування повідомлення у форматі UNIX TIME.|
|DAT7 …DAT8|ZONE_NUM|2|ZONE_NUM - номер зони (шлейфу). <br/> Можливі два варіанти нумерації зон: <br/> *наскрізна*: з максимальною кількістю зон до 32768 (біт 15 поля **DAT** дорівнює "1") <br/> *поблочна*: з максимальною кількістю зон до 254 і кількістю блоків до 255 (біт 15 поля DAT дорівнює "0"), формату 0хBB ZZ, де: <br/> **BB** - номер блоку (прилад, розширювач, клавіатура) <br/> **ZZ** - порядковий номер шлейфу в блоці. <br/> Біт 15 поля **DAT** використовується для визначення варіанта нумерації зон|
|DAT9|ZONE_TYPE|1|Тип зони: <br/> 0х00 - звичайна охоронна; <br/> 0х01 - вхідні двері; <br/> 0х02 - прохідна (коридор); <br/> 0х03 - тривожна кнопка; <br/> 0х04 - цілодобова; <br/> 0х05 - універсальна; <br/> 0х06 - технологічна; <br/> 0х07 - зона контролю тамперів; <br/> 0х08 - зона контролю маскування; <br/> 0х09 - інформаційна;|
|DAT10|ZONE_GUARD_STATE|1|Логічний стан зони: <br/> 0x00 - знято з охорони; <br/> 0x01 - під охороною; <br/> 0x02 - під охороною з підтвердженням від ПЦС; <br/> 0x03 - тривога; <br/> 0x04 - знято з охорони, обхід зони; <br/> 0x05 - несправність; <br/> 0x06 - інформаційна активація; <br/> 0x07 - вимкнена|
|DAT11|SENSORS_TYPE|1|Тип датчика (набору сенсорів)|
|DAT12|SENSORS_STATE|1|Номер сенсора в бітовій масці згідно з типом датчика (див. Додаток Б) починаючи з 1, <br/> 0 - інформація про сенсор відсутня.|

*Примітка. Формат підтвердження про приймання від ПЦС — [EVENT_ACK][EVENT_ACK]*

<br/>

<!-- WRL_DEV_ALARM_EVENT -->
Пакет **WRL_DEV_ALARM_EVENT** - Повідомлення від ППК про тривогу безпровідного пристрою.

|Поле|Назва поля|Довжина, байт|Опис|
|---|---|---|---|
|DAT0 …DAT1|EVENT|2|EVENT – код повідомлення від ППК (див. табл. 2.1.)|
|DAT2|PRIORITY|1|Пріоритет повідомлення: 0 - найвищий (тривоги)|
|DAT3 …DAT6|DATE/TIME|4|UNIXTIME - час формування повідомлення у форматі UNIX TIME.|
|DAT7 …DAT8|WRL_DEV_NUM|2|WRL_DEV_NUM — номер безпровідного пристрою.|
|DAT9 …DAT10|WRL_DEV_TYPE|2|Тип пристрою.|
|DAT11|ALARM_TYPE|1|Номер тривоги  в бітовій масці відповідно до типу пристрою (див. Додаток Б) починаючи з 1, <br/> 0 - інформація відсутня.|
|DAT12|ASSOCIATED_TYPE|1|Тип пов’язаного елемента: <br/> 0 – зона, <br/> 1 – користувач, <br/> 2 – модуль, <br/> 3 – вихід, <br/> 0xFF – прив’язка відсутня.|
|DAT13|ASSOCIATED_NUM|1|Номер пов’язаного елемента.|

*Примітка. Формат підтвердження про приймання від ПЦС — [EVENT_ACK][EVENT_ACK]  
Поля DAT12, DAT13 можуть бути відсутні (надсилаються не всіма приладами).*

<br/>

<!-- WRL_DEV_FAULT_EVENT -->
Пакет **WRL_DEV_FAULT_EVENT** - Повідомлення від ППК про несправність безпровідного пристрою.

|Поле|Назва поля|Довжина, байт|Опис|
|---|---|---|---|
|DAT0 …DAT1|EVENT|2|EVENT – код повідомлення від ППК (див. табл. 2.1.)|
|DAT2|PRIORITY|1|Пріоритет повідомлення: 0 - найвищий (тривоги)|
|DAT3 …DAT6|DATE/TIME|4|UNIXTIME - час формування повідомлення у форматі UNIX TIME.|
|DAT7 …DAT8|WRL_DEV_NUM|2|WRL_DEV_NUM — номер безпровідного пристрою.|
|DAT9 …DAT10|WRL_DEV_TYPE|2|Тип пристрою.|
|DAT11|FAULT_TYPE|1|Номер несправності в бітовій масці відповідно до типу пристрою (див. Додаток Б) починаючи з 1,<br/>0 - інформація відсутня.|
|DAT12|ASSOCIATED_TYPE|1|Тип пов’язаного елемента: <br/> 0 – зона, <br/> 1 – користувач, <br/> 2 – модуль, <br/> 3 – вихід, <br/> 0xFF – прив’язка відсутня.|
|DAT13|ASSOCIATED_NUM|1|Номер пов’язаного елемента.|

*Примітки: Формат підтвердження — [EVENT_ACK][EVENT_ACK]   
Поля DAT12, DAT13 можуть бути відсутні (надсилаються не всіма приладами).*

<br/>

<!-- WRL_DEVICES_ALARM_STATE -->
Пакет **WRL_DEVICES_ALARM_STATE** — Відповідь на запит поточних тривог та несправностей безпровідних пристроїв

|Поле|Назва поля|Довжина, байт|Опис|
|---|---|---|---|
|DAT0 …DAT1|EVENT|2|EVENT – код повідомлення від ППК (див. табл. 2.1.|
|DAT2|PRIORITY|1|Пріоритет повідомлення: 0 - найвищий (тривоги)|
|DAT3 - DAT4|STATE_FORMAT|2|Формат даних полів WRL_DEV_ALRM_STATE: <br/> 0x01 – 7 байтів: <br/> байти 0-1: номер пристрою; <br/> байт 2: тип пристрою; <br/> байти 3-4: бітова маска тривог, <br/> байти 5-6: бітова маска несправностей <br/> див. Додаток Б <br/> 0x02 – 10 байтів: <br/> байти 0-6: такі самі, як для формату 0x01; <br/> байт 7: стан вимкнення: <br/> 0 – пристрій активний; <br/> 1 – пристрій вимкнений. <br/> байт 8: тип пов’язаного елемента: <br/> 0 – зона, <br/> 1 – користувач, <br/> 2 – модуль, <br/> 3 – вихід, <br/> 0xFF – прив’язка відсутня. <br/> байт 9: номер пов’язаного елемента.|
|DAT5… <br/> <br/> <br/>|WRL_DEV_ALRM_STATE[1] <br/> ... <br/> WRL_DEV_ALRM_STATE[N]|7..10 <br/> <br/> 7..10|Наявні тривоги та несправності безпровідних пристроїв у форматі заданому в полі STATE_FORMAT.|

*Примітки: Формат підтвердження про приймання від ПЦС — [EVENT_ACK][EVENT_ACK]*

<br/>

<!-- CIRCUIT_EVENT -->
Пакет **CIRCUIT_EVENT** - Повідомлення від контрольованих кіл ППК: "Тривога", "Несправність" і "Вимкнення".

|Поле|Назва поля|Довжина, байт|Опис|
|---|---|---|---|
|DAT0 …DAT1|EVENT|2|EVENT – подія/повідомлення від ППК, згідно з табл. 2.1|
|DAT2|PRIORITY|1|Пріоритет повідомлення: 0 - найвищий (тривоги, пожежі), 1..3 - інші|
|DAT3 …DAT6|DATE/TIME|4|UNIXTIME - час формування повідомлення у форматі UNIX TIME.|
|DAT7 ...<br/><br/><br/>... DATn|CIRCUIT1 <br/> CIRCUIT2 <br/> .... <br/> CIRCUITn <br/> |4 <br/> 4 <br/> <br/> 4 |CIRCUITх - джерело повідомлення. Формат див. табл.  2.1.  Максимальна кількість полів CIRCUITх в одному пакеті - 124 (0x7С).|

*Примітки: Формат підтвердження про приймання від ПЦС — [EVENT_ACK][EVENT_ACK]*

<br/>

<!-- DATA_EVENT -->
Пакет **DATA_EVENT** - Пересилання даних.

|Поле|Назва поля|Довжина, байт|Опис|
|---|---|---|---|
|DAT0 …DAT1|EVENT|2|EVENT – подія/повідомлення від ППК, згідно з табл. 2.1|
|DAT2|PRIORITY|1|Пріоритет повідомлення: 0 - найвищий (тривоги, пожежі), 1..3 - інші|
|DAT3 …DAT6|DATE/TIME|4|UNIXTIME - час формування повідомлення у форматі UNIX TIME.|
|DAT7 ... DATn|DATA|1... 493|Максимальна кількість даних в одному пакеті - 493 байти.|

*Примітки: Формат підтвердження про приймання від ПЦС — [EVENT_ACK][EVENT_ACK]*

<br/>

<!-- ZONE_STATUS -->
Пакет **ZONE_STATUS** - відповідь на запит стану зон.

|Поле|Назва поля|Довжина, байт|Опис|
|---|---|---|---|
|DAT0 …DAT1|EVENT|2|EVENT – подія/повідомлення від ППК, згідно з табл. 2.1|
|DAT2|PRIORITY|1|Пріоритет повідомлення: 0 - найвищий (тривоги, пожежі), 1..3 - інші|
|DAT3 ...DAT4|FIRST ZONE|2|Номер зони, з якої починається список у ZONE1.|
|DAT5 ... <br/> <br/> <br/> ... DATn| STAT_ZONE1 <br/> STAT_ZONE2 <br/> .... <br/> STAT_ZONEn| 2 <br/> 2 <br/> <br/> 2|Поточний стан зони (шлейфу). <br/> Максимальна кількість полів [STAT_ZONE](http) в одному пакеті - 247. Зони у списку STAT_ZONE1 ... STAT_ZONEn обов'язково йдуть підряд, починаючи із зони FIRST ZONE і кроком, що збільшується на одиницю.|

*Примітки: Формат підтвердження про приймання від ПЦС — [EVENT_ACK][EVENT_ACK]*

<br/>

<!-- ZONE_SENSORS_STATE -->
Пакет **ZONE_SENSORS_STATE**  - відповідь на запит стану зон.

|Поле|Назва поля|Довжина, байт|Опис|
|---|---|---|---|
|DAT0 … DAT1|EVENT|2|EVENT – подія/повідомлення від ППК, згідно з табл. 2.1|
|DAT2|PRIORITY|1|Пріоритет повідомлення: 0 - найвищий (тривоги, пожежі), 1..3 - інші|
|DAT3 ...DAT4|STATE_FORMAT|1|Формат даних полів<br/> ZONE_STATE: <br/> 0x02 - 7 байт:<br/> байти 0-1: номер зони;<br/> байт 2: тип зони:<br/>   0х00 - звичайна охоронна;<br/>   0х01 - вхідні двері;<br/>   0х02 - прохідна (коридор);<br/>   0х03 - тривожна кнопка;<br/>   0х04 - цілодобова;<br/>   0х05 - універсальна;<br/>   0х06 - технологічна;<br/>   0х07 - зона контролю тамперів;<br/>   0х08 - зона контролю маскування;<br/>   0x09 - інформаційна;<br/> байт 3: логічний стан зони:<br/>   0x00 - знято з охорони;<br/>   0x01- під охороною;<br/>   0x02 - під охороною з підтвердженням від ПЦС;<br/>   0x03 - тривога;<br/>   0x04 - знято з охорони, обхід зони;<br/>   0x05 - несправність;<br/>   0x06 - інформаційна активація;<br/>   0x07 - вимкнена<br/> байт 4: тип датчика (набору сенсорів);<br/> байти 5-6: бітова маска порушених сенсорів:
|DAT5 ... <br/> <br/> <br/> ... DATn|ZONE_STATE1 <br/> ZONE_STATE2 <br/> .... <br/> ZONE_STATEn|Задано в STATE_FORMAT <br/>  Згідно Задано в STATE_FORMAT <br/> <br/> Задано в STATE_FORMAT|Поточний стан сенсорів зони (шлейфу) у форматі згідно з полем STATE_FORMAT.|

*Примітки: Формат підтвердження про приймання від ПЦС — [EVENT_ACK][EVENT_ACK]*

<br/>

<!-- SCRIPT_EVENT -->
Пакет **SCRIPT_EVENT** - Повідомлення, сформоване в дії сценарію (не змінює стан ППК)
|Поле|Назва поля|Довжина, байт|Опис|
|---|---|---|---|
|DAT0 …DAT1|EVENT|2|EVENT – код повідомлення від ППК  (див. табл.  2.1)|
|DAT2|PRIORITY|1|Пріоритет повідомлення: 0...3|
|DAT3 ...DAT6|DATE/TIME|4|UNIXTIME|
|DAT7|SCRIPT_EVENT_FORMAT|1|Формат даних полів SCRIPT_EVENT_DATA: <br/> 0x01 - Формат №1 (2 байти) <br/> Байт 0 - номер сценарію <br/> Байт 1 - подія згідно Додаток В <br/> 0x02...0xFF - резерв|
|DAT8... DATn|SCRIPT_EVENT_ DATA|Задано в SCRIPT_EVENT_FORMAT|Дані повідомлення у форматі залежно від поля SCRIPT_EVENT_FORMAT|

*Примітки: Формат підтвердження про приймання від ПЦС — [EVENT_ACK][EVENT_ACK]*

<br/>

<!-- ALERT_EVENT -->
Пакет **ALERT _EVENT** - Оповіщення про надзвичайні ситуації.

|Поле|Назва поля|Довжина, байт|Опис|
|---|---|---|---|
|DAT0 …DAT1|EVENT|2|EVENT – подія/повідомлення від ППК, згідно з табл. 2.1|
|DAT2|PRIORITY|1|Пріоритет повідомлення: 0 - найвищий (тривоги, пожежі), 1..3 - інші|
|DAT3 …DAT6|DATE/TIME|4|UNIXTIME - час формування повідомлення у форматі UNIX TIME.|
|DAT7|AIR_ALERT|1|Стан повітряної тривоги: <br/> 0 - відсутня,<br/> 1 - активна|
|DAT8 ...DAT11|ALERT_TIME|4|UNIXTIME - час формування стану повітряної тривоги у форматі UNIX TIME.|

*Примітки: Формат підтвердження про приймання від ПЦС — [EVENT_ACK][EVENT_ACK]*


<!-- СФОРМОВАНІ В РЕЗУЛЬТАТІ ДІЇ -->

## 2.2  СФОРМОВАНІ В РЕЗУЛЬТАТІ ДІЇ

<!-- USER_EVENT -->
Пакет **USER_EVENT** - Повідомлення сформоване в результаті дій користувача

|Поле|Назва поля|Довжина, байт|Опис|
|---|---|---|---|
|DAT0 …DAT1|EVENT|2|EVENT – подія/повідомлення від ППК, згідно з табл. 2.1|
|DAT2|PRIORITY|1|Пріоритет повідомлення: 0 - найвищий (тривоги, пожежі), 1..3 - інші|
|DAT3 …DAT6|DATE/TIME|4|UNIXTIME - час формування повідомлення|
|DAT7|USER|1|USER - номер користувача в ППК; <br/> 0х00 - користувач невідомий (під час опитування); <br/> 0хFF - користувач ПЦС. <br/> **Якщо ACCESS_TYPE=0x07 - у полі USER приходить номер сценарію (1..n)**|
|DAT8|ACCESS_TYPE|1|00 з локально (для сумісності) <br/> 01 - невідомо (для сумісності) <br/> 02 - ПЦС <br/> 03 - код доступу (клавіатура) <br/> 04 - TouchMemory <br/> 05 - брелок (X-Key, SpaceControl) <br/> 06 - зчитувач NFC <br/> 07 - сценарій <br/> 08 - автопостановка <br/> 09 - TirasCLOUD <br/> 0А -  E-Card|
|DAT9 ...DATn|DATA|0 ... 493|DATA - дані, згідно з табл.  2.1.|

*Примітки.*
1. *Залежно від поля EVENT поле даних DATA може бути відсутнім.*
2. *Формат підтвердження про прийом від ПЦС - [див. табл. 2.1](http)*

<!-- ПІДТВЕРДЖЕННЯ (ACK) -->
## 2.3   ПІДТВЕРДЖЕННЯ (ACK)

<!-- EVENT_ACK -->
Підтвердження **EVENT_ACK** від ПЦС. 

|Поле|Назва поля|Довжина, байт|Опис|
|---|---|---|---|
|DAT0 …DAT1|EVENT|2|EVENT - подія/повідомлення від ППК, на яке надіслано підтвердження.|
|DAT2 ...DAT5|REALTIME|4|REALTIME - поточний час на ПЦС у форматі UNIX TIME. <br/> Використовується для синхронізації часу з ППК.|

<br/>

<!-- USER_ACK -->

Підтвердження **USER_ACK** від ПЦС.

|Поле|Назва поля|Довжина, байт|Опис|
|---|---|---|---|
|DAT0 …DAT1|EVENT|2|EVENT - подія/повідомлення від ППК, на яке надіслано підтвердження.|
|DAT2 ...DAT5|REALTIME|4|REALTIME - поточний час на ПЦС у форматі UNIX TIME.|
|DAT6 ...DATn|DATA|1|DATA - дані повторюють поля DATA пакета USER_EVENT.|

*Примітка. Залежно від поля EVENT поле даних DATA може бути відсутнім.*

<br/>

<!-- DEVICE_CFG -->

Пакет **DEVICE_CFG** - Поточні налаштування

|Призначення поля|Розмір, байт|Значення
|---|---|---|
|EVENT_CODE|2|Код команди згідно з **таблицею  2.1.**|
|PRIORITY|1|Пріоритет повідомлення: 0 - найвищий (тривоги, пожежі), 1..3 - решта|
|OPTION1[ ] <br/> OPTIONn[ ]| 4...237| **OPT_TYPE** (1 байт) - тип опції. <br/> **OPT_NUM** (2 байти) - належність опції до однотипної групи (наприклад, USER1 - 0x1, USER2 - 0x2 тощо. 0 - немає належності); <br/> **OPT_LEN** (1 байт) - розмір опції (у байтах, byte2 ... byte x); <br/> **OPT_DATA**[OPT_LEN] - дані опції; <br/> Опис опцій - таблиця 5.1. |

*Примітки.*
1. *Підтвердження від сервера на пакет **CURR_CONFIG** у форматі - [USER_ACK](http)*
2. *Кількість полів OPTION залежить від їхньої довжини, яка сумарно не має перевищувати 237 байт.*

<br/>

<!-- DEVICE_CFG option -->

Опції конфігурації **DEVICE_CFG**.

|Опція|Код опції OPT_TYPE|Приналежність OPT_NUM|Довжина OPT_LEN|Дані опції OPT_DATA|
|---|---|---|---|---|
|**Налаштування користувачів**|
|І'мя|0x01|USER_#|1..40|Символи, у форматі ASCII.|
|Повноваження|0x02|USER_#|1|Бітова маска, біт=0 - повноваження відсутнє, 1- наявне: <br/> Біт : Повноваження <br/> 0 - базовий доступ (завжди 1 для активних користувачів), <br/> 1 - постановка, <br/> 2 - зняття <br/> 3 - адміністратор, <br/> 4 - установник, <br/> 5 - обхід зон, <br/> 6 - обхід несправностей|
|Групи|0x04|USER_#|1..32|бітовий масив, задіяні зони, виходи чи групи передані побітно: значення біт = 0 - не задіяна, 1 - задіяна. Приклад для передавання зон 1,5,7,10 та 16: <br/> ![alt ](./photo6.png)<tr><td colspan=5><b>Налаштування зон і груп</b></td><tr>
|І'мя зони|0x21|ZONE_#|1..40|Символи, у форматі ASCII.|
|Ім'я групи|0x22|GROUP_#|1..40|Символи, у форматі ASCII.|
|Зони в групі|0x23|GROUP_#|1..32|Формат аналогічний зонам/групам у "налаштуваннях користувачів"|
|Прив'язка зон|0x24|ZONE_#|3|байт1: # пристрою <br/> байт2: # зони в межах пристрою <br/> байт3: тип пристрою|
|Тип зони|0x25|ZONE_#|1|Можливі типи зон: <br/> 0 - звичайна охоронна, <br/> 1 - вхідні двері, <br/> 2 - коридор, <br/> 3 - тиха тривога, <br/> 4 - цілодобова, <br/> 5 - універсальна, <br/> 6 - вхід, <br/> 7 - тамперна зона, <br/> 8 - зона маскування. <br/> 9 - інформаційна;|
|Додаткові опції зони|0x26|ZONE_#|1|Бітова маска:<br/> 0 - "я вдома"|
|Активність зони|0x27|ZONE_#|1|0 - вимкнено, <br/> 1 - увімкнено.<tr><td colspan=5><b>Налаштування КНС</b></td></tr>
|Активність графіка КНС|0x36|SGM_#|1|0 - не використовується, <br/> 1 - увімкнено, <br/> 2 - вимкнено.|
|Ім'я графіка КНС|0x37|SGM_#|0..40|Символи, у форматі ASCII.<tr><td colspan=5><b>Налаштування модулів (клавіатури, модулі розширення)</b></td></tr>
|Ім'я модуля|0x51|EXT_#|0..40|Символи, у форматі ASCII.|
|ID модуля|0x52|EXT_#|0..40|Символи, у форматі ASCII.|
|Тип модуля|0x53|EXT_#|0..40|Символи, у форматі ASCII.|
|Активність модуля|0x54|EXT_#|1|0 - вимкнено, <br/> 1 - увімкнено.<tr><td colspan=5><b>Системні налаштування</b></td></tr>
|Канали зв'язку|0x65|0|1|Бітовий масив: (0-off; 1-on) <br/> 0 - SIM1; <br/> 1 - SIM2; <br/> 2 - Ethernet; <br/> 3 - WiFi<tr><td colspan=5><b>Налаштування бездротових пристроїв</b></td></tr>
|Назва пристрою|0x71|WRL_D_#|0..40|Символи, у форматі ASCII.|
|Тип (код) пристрою|0x72|WRL_D_#|1|Код пристрою (див. Додаток Б).|
|Тип пов'язаногоелемента|0x73|WRL_D_#|1|0 - зона, <br/> 1 - користувач, <br/> 2 - модуль, <br/> 3 - вихід, <br/> 0xFF - прив'язка відсутня.|
|Номер пов'язаного елемента|0x74|WRL_D_#|1|Номер пов'язаного елемента.|
|Активність пристрою|0x75|WRL_D_#|1|0 - вимкнено, <br/> 1 - увімкнено.<tr><td colspan=5><b>Передавання контрольних сум налаштувань</b></td></tr>
|Початок передачі CRC налаштувань|0xF0|0|2|0|
|CRC користувачів|0xF1|USER_#|2|CRC16|
|CRC зон|0xF2|0|2|CRC16|
|CRC груп зон|0xF3|0|2|CRC16|
|CRC сценаріїв|0xF5|0|2|CRC16|
|CRC модулів|0xF6|0|2|CRC16|
|CRC системних налаштувань|0xF7|0|2|CRC16|
|CRC бездротових пристроїв|0xF8|0|2|CRC16||
|CRC КНС|0xF9|0|2|CRC16|
|Завершення передачі CRC налаштувань|0xFF|0|2|0|

*Примітки.*
1. *У конфігурації користувачів прилад передасть тільки тих користувачів, які відмічені як зареєстровані на сервері.*
2. *Налаштування зон, груп, виходів і сценаріїв будуть передані в обсязі, який використовується зареєстрованими на сервері користувачами (відповідно до налаштувань користувачів).*

<!-- ТИПИ ПОВІДОМЛЕНЬ -->
           
## 2.4 ТИПИ ПОВІДОМЛЕНЬ

**Таблиця 2.1** - Типи повідомлень

<table style="width: 100%">
  <thead>
    <tr>
      <th colspan=2>Значення поля EVENT</th>
      <th colspan=2>Значення полів DAT</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Код (hex)</td>
      <td>Опис</td>
      <td>Значення (hex)</td>
      <td>Опис</td>
    </tr>
    <tr>
      <th colspan=4><b>Автоматичні тривоги</b></th>
    </tr>
    <tr>
      <td>0х0001</td>
      <td>Тривога охоронної зони - обрив</td>
      <td colspan=2 rowspan=6>Формат - див.<a href="">"Зони в нормі";</a></td>
    </tr>
    <tr>
      <td>0х0002</td>
      <td>Тривога охоронної зони - замикання</td>
    </tr>
    <tr>
      <td>0х0003</td>
      <td>Тривога пожежа зони</td>
    </tr>
    <tr>
      <td>0х0004</td>
      <td>Тривога передпожежної зони</td>
    </tr>
    <tr>
      <td>0х0005</td>
      <td>Автоматичне відновлення зони з тривоги</td>
    </tr>
    <tr>
      <td>0х0006</td>
      <td>Відновлення зони з тривоги вручну</td>
    </tr>
    <tr>
      <td>0х0007</td>
      <td>Зона(и) в нормі</td>
      <td>0х0001 ...0хFFFF <br/>
      0хBB ZZ<br/>
      BB = 0x00 ...0xFF<br/>
      ZZ = 0x01 ...0xFF</td>
      <td><b>Формат даних: <a href="">ZONE EVENT</a></b>
        <br/><b>Формат підтвердження: <a href="">EVENT_ACK</a>
        <br/>Поле: ZONEx (довжина - 2 байти)</b>. Можливі два варіанти нумерації зон:
        <br/><b>наскрізна</b>: з максимальною кількістю зон до 32768 (біт 15 поля DAT дорівнює "1")
        <br/><b>поблочна</b>: з максимальною кількістю зон до 254 і кількістю блоків до 255 (біт 15 поля <b>DAT</b> дорівнює "0"), де: 
        <br/><b>BB</b> - номер блоку (прилад, розширювач, клавіатура)
        <br/><b>ZZ</b> - порядковий номер шлейфу в блоці.
        <br/>Біт 15 поля <b>DAT</b> використовується для визначення варіанта нумерація зон</td>
    </tr>
    <tr>
      <td>0х0008</td>
      <td>Розпочато процедуру зняття із затримкоюТривога тампера компонета зони</td>
      <td colspan=2 rowspan=3>Формат - див.<a href="">"Зони в нормі";</a></td>
    </tr>
    <tr>
      <td>0х0009</td>
      <td>Тривога в Тамперній зоні (тип зони, для відстеження стану тамперів зовнішніх пристроїв)</td>
    </tr>
    <tr>
      <td>0х000A</td>
      <td>Тривога маскування датчика</td>
    </tr>
    <tr>
      <td>0х0010</td>
      <td>Тривога сенсора зони</td>
      <td colspan=2 rowspan=8><b>Формат даних:<a href="">_EVENT</a> 
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a></b></td>
    </tr>
    <tr>
      <td>0х0011</td>
      <td>Відновлення сенсора зони</td>
    </tr>
    <tr>
      <td>0х0012</td>
      <td>Тиха тривога сенсора зони (напад)</td>
    </tr>
    <tr>
      <td>0х0013</td>
      <td>Відновлення тихої тривоги сенсора зони</td>
    </tr>
    <tr>
      <td>0х0014</td>
      <td>Несправність сенсора зони</td>
    </tr>
    <tr>
      <td>0х0015</td>
      <td>Відновлення несправності сенсора зони</td>
    </tr>
    <tr>
      <td>0х0016</td>
      <td>Інформаційне порушення сенсора зони</td>
    </tr>
    <tr>
      <td>0х0017</td>
      <td>Інформаційне відновлення сенсора зони</td>
    </tr>
    <tr>
      <td>0х0030</td>
      <td>Тривога від пристрою</td>
      <td rowspan=2>0хNNССBBTT 
        <br/> TT, BB, CC, NN = 0x00 ... 0xFF</td>
      <td rowspan=2><b>Формат даних: <a href="">CIRCUIT EVENT</a>
        <br/>Формат підтвердження: <a href="">EVENT_ACK</a> 
        <br/>Поле: CIRCUITх (довжина - 4 байти).</b> 
        <br/>формат поля: <b>0хNNNССBBTTT</b> 
        <br/> <b>TT</b> - тип блоку(пристрою): 
        <br/> 0х00 - прилад (ППК, ППКП тощо);
        <br/> 0х01 - клавіатура; 
        <br/> 0х02 - розширювач шлейфів; 
        <br/> 0х03 - розширювач виходів; 
        <br/> 0х04 - зовнішній комунікатор; 
        <br/> 0х05 - зовнішній модуль (адресний, радіо тощо); 
        <br/> 0х06 - пристрій пожежогасіння. 
        <br/> 0х07 - зона (або компонент зони); 
        <br/> <b>BB</b> - номер блоку; 
        <br/> <b>CC</b> - джерело: 
        <br/> 0х00 - тампер; 
        <br/> 0х01 - підбір коду. 
        <br/> <b>NN</b> - номер кола за порядком, 0х00 - номер кола не визначено.</td>
    </tr>
    <tr>
      <td>0х0036</td>
      <td>Тривога від пристрою (опитування)</td>
    </tr>
    <tr>
      <td>0х0032</td>
      <td>Jamming detect - канал заглушено</td>
      <td rowspan=3>0хAABBССDD</td>
      <td rowspan=3><b>Формат даних: <a href="">CIRCUIT EVENT</a>
        <br/>Формат підтвердження: <a href="">EVENT_ACK</a>
        <br/>Поле CIRCUIT1 (довжина - 4 байти).</b> Значення поля - див. <a href="">Типи каналів</a> у TEST_EVENT.</td>
    </tr>
    <tr>
      <td>0х0034</td>
      <td>Інтерференція сигналу</td>
    </tr>
    <tr>
      <td>0х0035</td>
      <td>Канал відновлено</td>
    </tr>
    <tr>
      <td>0x0037</td>
      <td>Тривога бездротового пристрою</td>
      <td colspan=2>Формат даних WRL_DEV_ALARM_EVENT</td>
    </tr>
    <tr>
      <td>0x0038</td>
      <td>Відновлення тривоги бездротового пристрою</td>
      <td colspan=2>Формат даних WRL_DEV_ALARM_EVENT</td>
    </tr>
    <tr>
      <td>0x0039</td>
      <td>Повідомлення про тривогу (від сценарію)</td>
      <td colspan=2>Формат даних  SCRIPT_EVENT</td>
    </tr>
    <tr>
      <th colspan=4><b>Тривоги вручну</b></th>
    </tr>
    <tr>
      <td>0x0040</td>
      <td>Виклик швидкої допомоги</td>
      <td rowspan=3>0хBBZZ 
        <br/> BB, ZZ = 0x00 ... 0xFF <br/> ZZZZZ = 0x0001... 0xFFFFFF</td>
      <td rowspan=3><b>Формат даних: <a href="">USER_EVENT</a> 
        <br/> Формат підтвердження: <a href="">USER_ACK</a> 
        <br/> Поле: DATA (довжина - 2 байти). </b>
        <br/> BBZZ - див. <a href="">"Зони в нормі";</a>; 
        <br/> <b>BB</b> - номер блоку в приладі; 
        <br/> <b>ZZ (ZZZZZZ)</b> - порядковий номер зони (шлейфу) в блоці або системі.</td>
    </tr>
    <tr>
      <td>0x0041</td>
      <td>Виклик пожежної команди</td>
    </tr>
    <tr>
      <td>0х0042</td>
      <td>Виклик наряду міліції (тривожна кнопка)</td>
    </tr>
    <tr>
      <td>0х0043</td>
      <td>Доступ під примусом 
        <br/><b>Примітка:</b> наприклад, для зняття з охорони.</td>
      <td rowspan=2></td>
      <td rowspan=2><b>Формат даних: <a href="">USER_EVENT</a> 
        <br/> Формат підтвердження: <a href="">USER_ACK</a> </b>
        <br/> Поля DATA відсутні.</td>
    </tr>
    <tr>
      <td>0х0044</td>
      <td>Тривожна кнопка користувача (брелок)</td>
    </tr>
    <tr>
      <td>0х0045</td>
      <td>Тривожна кнопка користувача (додаток)</td>
      <td></td>
      <td><b>Формат даних: <a href="">USER_EVENT</a> 
        <br/> Формат підтвердження: <a href="">USER_ACK</a> </b>
        <br/> У поле DATA передаються координати рядком.</td>
    </tr>
    <tr>
      <td>0х0046</td>
      <td>Стан оповіщення про надзвичайну ситуацію (опитування)</td>
      <td></td>
      <td>Формат даних: ALERT_EVENT</td>
    </tr>
    <tr>
      <th colspan=4><b>Тривоги (пожежогасіння)</b></th>
    </tr>
    <tr>
      <td>0х0060</td>
      <td>Активація пожежогасіння вручну</td>
      <td rowspan=6>0хNNССBBTT 
        <br/> TT, BB, CC, NN = 0x00 ... 0xFF</td>
      <td rowspan=6><b>Формат даних: <a href="">CIRCUIT EVENT</a> 
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a> 
        <br/> Поле: CIRCUITх (довжина - 4 байти). </b>
        <br/> формат поля: 0хTTTBBССNN 
        <br/> <b>TT</b> - тип блоку(пристрою): 
        <br/> 0х06 - пристрій пожежогасіння. 
        <br/> <b>BB</b> - номер пристрою (адреса); 
        <br/> <b>CC</b> - логічний пристрій (наприклад, два пристрої на одній платі); 
        <br/> <b>NN</b> - номер кола за порядком, 0х00 - номер кола не визначено.</td>
    </tr>
    <tr>
      <td>0х0061</td>
      <td>Запуск пожежогасіння вручну</td>
    </tr>
    <tr>
      <td>0х0062</td>
      <td>Випуск вогнегасної речовини</td>
    </tr>
    <tr>
      <td>0х0063</td>
      <td>Гасіння ввімкнено</td>
    </tr>
    <tr>
      <td>0х0064</td>
      <td>Активація пожежогасіння</td>
    </tr>
    <tr>
      <td>0х0065</td>
      <td>Скасування активації пожежогасіння</td>
    </tr>
    <tr>
      <th colspan=4><b>Група несправностей</b></th>
    </tr>
    <tr>
      <td>0х0100</td>
      <td>Несправність зон(и)</td>
      <td colspan=2>Формат - див.<a href="">"Зони в нормі";</a></td>
    </tr>
    <tr>
      <td>0х0101</td>
      <td>Несправність живлення</td>
      <td rowspan=3>0хNNССBBTT
        <br/>TT, BB, CC, NN = 0x00 ... 0xFF</td>
      <td rowspan=3><b>Формат даних: <a href="">CIRCUIT EVENT</a> 
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a> 
        <br/> Поле: CIRCUITх (довжина - 4 байти). </b>
        <br/> <b>TT</b> - див. "<a href="">тип блоку</a>"; 
        <br/> <b>BB</b> - номер блоку; 
        <br/> <b>CC</b> - джерело: 
        <br/> 0х00 - основного живлення; 
        <br/> 0х01 - резервного живлення; 
        <br/> 0х02 - зовнішнього живлення; 
        <br/> 0х03 - розряд батареї (U < 11,5V); 
        <br/> 0х04 - немає батареї (U < 3,0V); 
        <br/> 0х05 - батарея несправна (U < 9,5V); 
        <br/> 0х06 - ресурс батареї вичерпано; 
        <br/> 0х07 - зарядного пристрою; 
        <br/> 0х08 - відключення від батареї (батарея повністю розряджена). 
        <br/> <b>NN</b> - номер кола за порядком, 0х00 - номер кола не визначено. 
        <br/> <b>** якщо поля CIRCUIT у відповіді відсутні, всі кола живлення в нормі</b></td>
    </tr>
    <tr>
      <td>0х0102</td>
      <td>Харчування в нормі</td>
    </tr>
    <tr>
      <td>0x010F</td>
      <td>Несправність живлення (опитування)</td>
    </tr>
    <tr>
      <td>0х0103</td>
      <td>Несправність кола</td>
      <td rowspan=3>0хNNССBBTT
        <br/>TT, BB, CC, NN = 0x00 ... 0xFF</td>
      <td rowspan=3><b>Формат даних: <a href="">CIRCUIT EVENT</a> 
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a> 
        <br/> Поле: CIRCUITх (довжина - 4 байти).</b> 
        <br/> <b>TT</b> - див. "<a href="">тип блоку</a>"; 
        <br/> <b>BB</b> - номер блоку; 
        <br/> <b>CC</b> - джерело: 
        <br/> 0х00 - вихід живлення; 
        <br/> 0х01 - сповіщення; 
        <br/> 0х02 - реле; 
        <br/> 0х03 - відкритий колектор; 
        <br/> 0х04 - керованого; 
        <br/> пожежні починаючи з 0х10:
        <br/> 0х10 - пожежогасіння; 
        <br/> 0х11 - реле пожежа; 
        <br/> 0х12 - реле несправність; 
        <br/> <b>NN</b> - номер кола за порядком, 0х00 - номер кола не визначено.</td>
    </tr>
    <tr>
      <td>0х0104</td>
      <td>Несправність кола (опитування)</td>
    </tr>
    <tr>
      <td>0х0105</td>
      <td>Коло у нормі</td>
    </tr>
    <tr>
      <td>0х0106</td>
      <td>Несправність інтерфейсу зв'язку</td>
      <td rowspan=3>0хNNССBBTT
        <br/>TT, BB, CC, NN = 0x00 ... 0xFF</td>
      <td rowspan=3><b>Формат даних: <a href="">CIRCUIT EVENT</a> 
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a> 
        <br/> Поле: CIRCUITх (довжина - 4 байти).</b> 
        <br/> <b>TT</b> - див. "<a href="">тип блоку</a>"; 
        <br/> <b>BB</b> - номер блоку; 
        <br/> <b>CC</b> - джерело: 
        <br/> 0х00 - пристрій у блоці ТТ; 
        <br/> 0х10 - внутрішній комунікатор; 
        <br/> 0х11 - ПЗУ (накопичувач); 
        <br/> 0х12 - внутрішній модуль. 
        <br/> <b>NN</b> - номер кола за порядком, 0х00 - номер кола не визначено.</td>
    </tr>
    <tr>
      <td>0х0107</td>
      <td>Несправність інтерфейсу зв'язку (опитування)</td>
    </tr>
    <tr>
      <td>0х0108</td>
      <td>Інтерфейс справний</td>
    </tr>
    <tr>
      <td>0х0109</td>
      <td>Несправність бездротового компонента (зони)</td>
      <td rowspan=3>0хZZZZZFFТТ 
        <br/> CC = 0x00 ...0xFF 
        <br/> 0x0000 ...0xFFFFFF</td>
      <td rowspan=3><b>Формат даних: <a href="">CIRCUIT EVENT</a> 
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a> 
        <br/> Поле: CIRCUITх (довжина - 4 байти).</b> 
        <br/> <b>TT</b> - див. "<a href="">тип блоку</a>"; 
        <br/> <b>BB</b> - номер блоку; 
        <br/> <b>FF</b> - несправність: 
        <br/> 0х00 - низький рівень сигналу; 
        <br/> 0х01 - низький заряд батареї; 
        <br/> 0х02 - резерв; 
        <br/> 0х03 - глушіння сигналу; 
        <br/> 0х04 - втрата зв'язку; 
        <br/> <b>ZZZZZ</b> - віртуальна зона (номер) компонента. 0x00 - немає даних.</td>
    </tr>
    <tr>
      <td>0х010A</td>
      <td>Несправність бездротового компонента (опитування)</td>
    </tr>
    <tr>
      <td>0х010B</td>
      <td>Компонент у нормі</td>
    </tr>
    <tr>
      <td>0x010C</td>
      <td>Помилка конфігурації системи (неправильний CRC налаштувань)</td>
      <td>0хNNССBBTT
        <br/>TT, BB, CC, NN = 0x00 ... 0xFF</td>
      <td><b>Формат даних: <a href="">CIRCUIT EVENT</a> 
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a> 
        <br/> Поле: CIRCUITх (довжина - 4 байти). </b>
        <br/> <b>TT</b> - див. "<a href="">тип блоку</a>"; 
        <br/> BB - номер блоку; 
        <br/> <b>CC</b> - джерело: 
        <br/> 0х00 - internal Flash; 
        <br/> 0х10 - external Flash; 
        <br/> 0х11 - внутрішня пам'ять даних; 
        <br/> 0х12 - зовнішня пам'ять даних. 
        <br/> <b>NN</b> - номер ПЗП, 0х00 - не визначено.</td>
    </tr>
    <tr>
      <td>0x010D</td>
      <td>Замикання параметричного шлейфу</td>
      <td rowspan=2 colspan=2>Формат - див.<a href="">"Зони в нормі";</a></td>
    </tr>
    <tr>
      <td>0x010E</td>
      <td>Обрив параметричного шлейфу</td>
    </tr>
    <tr>
      <td>0x0120</td>
      <td>Несправність безпровідного пристрою</td>
      <td colspan=2>Формат даних WRL_DEV_FAULT_EVENT</td>
    </tr>
    <tr>
      <td>0x0121</td>
      <td>Відновлення несправності безпровідного пристрою</td>
      <td colspan=2>Формат даних WRL_DEV_FAULT_EVENT</td>
    </tr>
    <tr>
      <td>0x0122</td>
      <td>Повідомлення про несправність (від сценарію)</td>
      <td colspan=2>Формат даних  SCRIPT_EVENT</td>
    </tr>
    <tr>
      <td>0x0123</td>
      <td>Тривога КНС</td>
      <td colspan=2><b>Формат даних: <a href="">DATA_EVENT</a> 
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a> 
        <br/> DAT7</b> - номер розкладу КНС</td>
    </tr>
    <tr>
      <th colspan=4><b>Несправності (пожежогасіння)</b></th>
    </tr>
    <tr>
      <td>0x0131</td>
      <td>Несправність компонента пожежогасіння</td>
      <td rowspan=7>0хNNССBBTT
        <br/>TT, BB, CC, NN = 0x00 ... 0xFF</td>
      <td rowspan=7><b>Формат даних: <a href="">CIRCUIT EVENT</a> 
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a> 
        <br/> Поле: CIRCUITх (довжина - 4 байти).</b>
        <br/> формат поля: <b>0хNNNССBBTTT</b> 
        <br/> <b>TT</b> - тип блоку(пристрою): 
        <br/> 0х06 - пристрій пожежогасіння. 
        <br/> <b>BB</b> - номер пристрою (адреса);
        <br/> <b>CC</b> - логічний пристрій (наприклад, два пристрої на одній платі); 
        <br/> <b>NN</b> - номер кола за порядком, 0х00 - номер кола не визначено.</td>
    </tr>
    <tr>
      <td>0x0132</td>
      <td>Несправність входу активації</td>
    </tr>
    <tr>
      <td>0x0133</td>
      <td>Несправність входу ручного запуску</td>
    </tr>
    <tr>
      <td>0x0134</td>
      <td>Несправність входу скасування запуску</td>
    </tr>
    <tr>
      <td>0x0135</td>
      <td>Несправність входу моніторингу компонентів</td>
    </tr>
    <tr>
      <td>0x0136</td>
      <td>Несправність входу контролю випуску вогнегасної речовини</td>
    </tr>
    <tr>
      <td>0x0137</td>
      <td>Несправність виходу на установку пожежогасіння</td>
    </tr>
    <tr>
      <th colspan=4><b>Відключення</b></th>
    </tr>
    <tr>
      <td>0х0200</td>
      <td>Вимкнення зони</td>
      <td rowspan=3>0хBBZZ 
        <br/> ZZZ, BB = 0x00... 0xFF 
        <br/> ZZZZZ = 0x0001... 0xFFFFFF</td>
      <td rowspan=3><b>Формат даних: <a href="">USER_EVENT</a> 
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a> 
        <br/> Поле: DATAх (довжина - 2 байти).</b> 
        <br/> <b>BBZZ</b> - див. <a href="">"Зони в нормі";</a> 
        <br/> <b>BB</b> - номер блоку в приладі; 
        <br/> <b>ZZZZZ</b> - порядковий номер зони (шлейфу) в блоці або системі.</td>
    </tr>
    <tr>
      <td>0х0201</td>
      <td>Увімкнення зони</td>
    </tr>
    <tr>
      <td>0х0205</td>
      <td>Обхід зони під час постановки (Inhibited)</td>
    </tr>
    <tr>
      <td>0х0202</td>
      <td>Вимкнення кола</td>
      <td rowspan=4>0хNNССBBTT 
        <br/> TT, BB, CC, NN = 0x00 ... 0xFF</td>
      <td rowspan=4><b>Формат даних: <a href="">USER_EVENT</a> 
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a> 
        <br/> Поле: DATAх (довжина - 4 байти).</b> 
        <br/> <b>TT</b> - див. "<a href="">тип блоку</a>"; 
        <br/> <b>BB</b> - номер блоку (адреса); 
        <br/> <b>CC</b> - коло: 
        <br/> 0х00 - вихід без контролю; 
        <br/> 0х01 - вихід із контролем; 
        <br/> 0х02 - оповіщувач; 
        <br/> 0х03 - контроль резервного живлення; 
        <br/> 0х04 - контроль основного живлення. 
        <br/> <b>NN</b> - номер кола за порядком, 0х00 - номер кола не визначено.</td>
    </tr>
    <tr>
      <td>0х0203</td>
      <td>Увімкнення кола</td>
    </tr>
    <tr>
      <td>0х0204</td>
      <td>Відключені кола (опитування)</td>
    </tr>
    <tr>
      <td>0х0206</td>
      <td>Обхід кола під час постановки (Override)</td>
    </tr>
    <tr>
      <td>0х0207</td>
      <td>Вимкнення бездротового пристрою</td>
      <td rowspan=2>NNNN = 0x0001...0xFFFFFF</td>
      <td rowspan=2><b>Формат даних: <a href="">USER_EVENT</a> 
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a> 
        <br/> Поле: DATAх (довжина - 2 байти). 
        <br/> NNNNN</b> - порядковий номер бездротового пристрою.</td>
    </tr>
    <tr>
      <td>0х0208</td>
      <td>Увімкнення бездротового пристрою</td>
    </tr>
    <tr>
      <td>0х0209</td>
      <td>Вимкнення сценарію</td>
      <td rowspan=2>NNNN = 0x0001...0xFFFFFF</td>
      <td rowspan=2><b>Формат даних: <a href="">USER_EVENT</a> 
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a> 
        <br/> Поле: DATAх (довжина - 2 байти). 
        <br/> NNNNN</b> - порядковий номер сценарію.</td>
    </tr>
    <tr>
      <td>0х020A</td>
      <td>Увімкнення сценарію</td>
    </tr>
    <tr>
      <td>0х0231</td>
      <td>Скасування запуску</td>
      <td rowspan=2>0хNNССBBTT
        <br/> TT, BB, CC, NN = 0x00 ... 0xFF</td>
      <td rowspan=2><b>Формат даних: <a href="">USER_EVENT</a> 
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a> 
        <br/> Поле: DATAх (довжина - 4 байти). 
        <br/> TT </b> - див. "<a href="">тип блоку</a>"; 
        <br/> <b>BB</b> - номер блоку (адреса); 
        <br/> <b>CC</b> - логічний пристрій (наприклад, два пристрої на одній платі); 
        <br/> <b>NN</b> - номер кола за порядком, 0х00 - номер кола не визначено.</td>
    </tr>
    <tr>
      <td>0х0232</td>
      <td>Запуск призупинено</td>
    </tr>
    <tr>
      <th colspan=4><b>Службові</b></th>
    </tr>
    <tr>
      <td>0х0300</td>
      <td>Тест зв'язку</td>
      <td></td>
      <td><b>Формат даних: <a href="">TEST_EVENT</a>
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a></td>
    </tr>
    <tr>
      <td>0х0301</td>
      <td>Тип і версія приладу (передається тільки під час увімкнення приладу)</td>
      <td></td>
      <td><b>Формат даних: <a href="">TEST_EVENT</a>
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a></td>
    </tr>
    <tr>
      <td>0х0302</td>
      <td>Відповідь на запит стану зон</td>
      <td>0хTTSS 
        <br/> TT = 0x00 ...0xFF 
        <br/> SS = 0x00 ...0xFF</td>
      <td><b> Формат даних: <a href="">ZONE_STATUS</a>
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a>
        <br/> Поле: STAT_ZONE x (довжина - 2 байти).
        <br/> Статус зони: 
        <br/> TT </b> - тип зони: 
        <br/> 0х00 - звичайна охоронна; 
        <br/> 0х01 - вхідні двері; 
        <br/> 0х02 - прохідна (коридор); 
        <br/> 0х03 - тривожна кнопка; 
        <br/> 0х04 - цілодобова; 
        <br/> 0х05 - параметрична; 
        <br/> 0х06 - технологічна; 
        <br/> 0х07 - зона контролю тамперів; 
        <br/> 0х08 - зона контролю маскування; 
        <br/> 0x09 - інформаційна; 
        <br/> ... 
        <br/> <b>SS</b> - поточний стан: 
        <br/> 0х00 - знято, у нормі; 
        <br/> 0х01 - знято, обрив; 
        <br/> 0х02 - знято, замикання; 
        <br/> 0х03 - під охороною;   
        <br/> 0х04 - тривога, у нормі; 
        <br/> 0х05 - тривога, обрив; 
        <br/> 0х06 - тривога, замикання; 
        <br/> 0х07 - параметричний, у нормі; 
        <br/> 0х08 - параметричний, обрив; 
        <br/> 0х09 - параметричний, замикання; 
        <br/> 0х0А - параметричний, тривога 1; 
        <br/> 0х0В - параметричний, тривога 2; 
        <br/> 0х0С - вимкнено; 
        <br/> 0х0D - обхід зони; 
        <br/> 0х0E - тривога тампера;</td>
    </tr>
    <tr>
      <td>0х0303</td>
      <td>Налаштування змінено</td>
      <td></td>
      <td><b> Формат даних:<a href="">DATA_EVENT</a> 
        <br/> Формат підтвердження:<a href="">EVENT_ACK</a> 
        <br/> DAT7, DAT8</b> - CRC16 нових налаштувань ППК. </td>
    </tr>
    <tr>
      <td>0х0304</td>
      <td>Версію ПЗ оновлено</td>
      <td></td>
      <td><b> Формат даних: <a href="">IDT_EVENT</a> 
        <br/> Формат підтвердження:<a href="">EVENT_ACK</a></td>
    </tr>
    <tr>
      <td>0х0305</td>
      <td>Інкапсуляція інших протоколів</td>
      <td>DATn_max = 493 байти</td>
      <td><b> Формат даних: <a href="">DATA_EVENT</a> 
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a> 
        <br/> DAT7</b> - тип протоколу: 
        <br/> 0х00 - Contact ID; 
        <br/> 0х01 - Ademco; 
        <br/> 0х02 - Інтеграл; 
        <br/> 0x03 - Міст; 
        <br/> <b>DAT8...DATх</b> - дані.</td>
    </tr>
    <tr>
      <td>0х0306</td>
      <td>Передача даних</td>
      <td>DATn_max = 493 байти</td>
      <td><b> Формат даних: <a href="">DATA_EVENT</a> 
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a> 
        <br/> DAT7...DATх</b> - дані. </td>
    </tr>
    <tr>
      <td rowspan=2>0х0308</td>
      <td rowspan=2>Відповідь на запит поточного типу та версії ПЗ і наявності оновлень</td>
      <td>Дані 8 байт DAT7... DAT14</td>
      <td><b> Формат даних: <a href="">DATA_EVENT</a> 
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a> <br/> DAT7... DAT10</b> - поточна версія 
        <br/> <b>DD HH SS VV</b> 
        <br/> <b>DAT11... DAT14</b> - доступні оновлення 
        <br/> <b>DD HH SS VV</b> (відповідь від сервера) 
        <br/> Якщо перевірку версії на сервері не проведено (сервер недоступний, не підтримується приладом,   проходить завантаження оновлень) - усі поля 0х00.
        <br/> <b>0xDDHHSSVV:</b> 
        <br/> <b>DD</b> - тип приладу; 
        <br/> <b>HH</b> - версія апаратної частини; 
        <br/> <b>SS</b> - версія програмного забезпечення; 
        <br/> <b>VV</b> - ревізія програмного забезпечення.</td>
    </tr>
    <tr>
      <td>DAT15... (+32max)</td>
      <td>Назва приладу в у форматі рядка ASCII із закінченням рядка. Довжина поля змінна 1..32 байт.</td>
    </tr>
    <tr>
      <td>0х0309</td>
      <td>Серійний номер виробу</td>
      <td>Дані 8 байт DAT0... DAT7</td>
      <td><b> Формат даних: <a href="">DATA_EVENT</a> 
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a> </b></td>
    </tr>
    <tr>
      <td>0х030A</td>
      <td>Стан сенсорів зон у відповідь на запит стану зон</td>
      <td colspan=2><b> Формат даних: <a href="">ZONE_SENSORS_STATE </a> 
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a> </b></td>
    </tr>
    <tr>
      <td>0х030B</td>
      <td>Відповідь на запит наявних тривог і несправностей бездротових пристроїв</td>
      <td colspan=2><b> Формат даних: <a href="">WRL_DEVICES_ALARM_STATE</a> 
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a> </b></td>
    </tr>
    <tr>
      <td>0x030C</td>
      <td>Інформаційне повідомлення (від сценарію)</td>
      <td colspan=2><b> Формат даних: <a href="">SCRIPT_EVENT</a></td>
    </tr>
    <tr>
      <th colspan=4><b>Користувач</b></th>
    </tr>
    <tr>
      <td>0х0400</td>
      <td>Постановка зон(и) під охорону</td>
      <td rowspan=4>0х0001 ...0хFFFF 
        <br/> 0хBB ZZ 
        <br/> BB = 0x00 ...0xFF 
        <br/> ZZ = 0x01 ...0xFF</td>
      <td rowspan=4><b> Формат даних: <a href="">USER_EVENT</a> 
        <br/> Формат підтвердження: <a href="">USER_ACK</a> 
        <br/> Поле: DATAх (довжина - 2 байти). 
        <br/> BBZZZ або ZZZZ</b> 
        <br/> <b>BB</b> - номер блоку в приладі; 
        <br/> <b>ZZ (ZZZZZZ)</b> - порядковий номер зони (шлейфу) в блоці або системі.</td>
    </tr>
    <tr>
      <td>0х0401</td>
      <td>Зняття зон(и) з охорони</td>
    </tr>
    <tr>
      <td>0х0402</td>
      <td>Невдала постановка</td>
    </tr>
    <tr>
      <td>0х0403</td>
      <td>Автоматичне встановлення зони (перевстановлення)</td>
    </tr>
    <tr>
      <td>0х0404</td>
      <td>Вхід у рівень доступу</td>
      <td rowspan=2>0х00 ... 0хFF</td>
      <td rowspan=2><b> Формат даних: <a href="">USER_EVENT</a> 
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a> </b>
        <br/> Значення поля DATA0 (повноваження):
        <br/> 0х01 - другий (управління)
        <br/> 0х02 - другий (адміністратор)
        <br/> 0х03 - третій (конфігурація)
        <br/> 0x04 - другий (режим тестування зон)</td>
    </tr>
    <tr>
      <td>0х0405</td>
      <td>Вихід із рівня доступу</td>
    </tr>
    <tr>
      <td>0х0406</td>
      <td>Зміна коду доступу</td>
      <td>0х00 ... 0хFF</td>
      <td><b> Формат даних: <a href="">USER_EVENT</a> 
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a> </b>
        <br/> Значення поля DATA0 - номер користувача, якому змінили код.</td>
    </tr>
    <tr>
      <td>0х0407</td>
      <td>Розпочато процедуру зняття із затримкою</td>
      <td>0х00 ... 0хFF</td>
      <td><b> Формат даних: <a href="">DATA_EVENT</a> 
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a> </b>
        <br/> Значення поля DAT7 - номер зони, через яку здійснено вхід,
        <br/>DAT8 - час затримки в секундах.</td>
    </tr>
    <tr>
      <td>0х0408</td>
      <td>Режим "Я вдома" увімкнено</td>
      <td rowspan=2 colspan=2><b> Формат даних: <a href="">DATA_EVENT</a> 
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a> </b>
        <br/> Дані відсутні.</td>
    </tr>
    <tr>
      <td>0х0409</td>
      <td>Режим "Я вдома" вимкнений</td>
    </tr>
    <tr>
      <td>0х040A</td>
      <td>Вимкнення приладу</td>
      <td rowspan=2></td>
      <td rowspan=2><b> Формат даних: <a href="">USER_EVENT</a> 
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a> </b>
        <br/> Значення поля DATA0 - причина вимкнення/ перезавантаження:
        <br/> 0х00 - невідомо, 
        <br/> 0х01 - вимкнення кнопкою,
        <br/> 0х02 - АКБ розряджена,
        <br/> 0х03 - для оновлення,
        <br/> 0х04 - для застосування налаштувань,
        <br/> 0х05 - дія користувача.</td>
    </tr>
    <tr>
      <td>0х040B</td>
      <td>Перезавантаження приладу</td>
    </tr>
    <tr>
      <td>0х040С</td>
      <td>Ініційовано перехід на іншу SIM-картку</td>
      <td></td>
      <td><b> Формат даних: <a href="">USER_EVENT</a> 
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a> </b>
        <br/> Значення поля DATA0 - номер Sim-карти,
        <br/> DATA1 - причина переходу: 
        <br/> 0х01 - для тестування,
        <br/> 0х02 - запит USSD коду.
        <br/> Якщо DATA1=0x02 - номер користувача не аналізувати.</td>
    </tr>
    <tr>
      <td>0х040E</td>
      <td>Патрулювання виконано (КНС)</td>
      <td></td>
      <td><b> Формат даних: <a href="">DATA_EVENT</a> 
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a> </b>
        <br/> Поле DATA0 - номер графіка КНС,
        <br/> DATA1 - номер користувача.</td>
    </tr>
    <tr>
      <td>0х040F</td>
      <td>Невдала постановка групи за допомогою сценарію</td>
      <td></td>
      <td><b> Формат даних: <a href="">DATA_EVENT</a> 
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a> </b>
        <br/> Поле DATA[0] - номер сценарію,
        <br/> DATA[1] ... DATA[N] - перелік груп, які не вдалося поставити (по 1 байту на групу).</td>
    </tr>
    <tr>
      <th colspan=4><b>Сервіс</b></th>
    </tr>
    <tr>
      <td>0х0500</td>
      <td>Зміна каналу зв'язку</td>
      <td>0x00 ...0xFF</td>
      <td><b> Формат даних: <a href="">DATA_EVENT</a> 
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a> 
        <br/> DAT7</b> - код помилки зв'язку:
        <br/> 0х00 - слабкий сигнал;
        <br/> 0х01 - сервіс не доступний (CSD, GPRS);
        <br/> 0х02 - немає реєстрації;
        <br/> 0х03 - немає з'єднання з точкою доступу;
        <br/> 0x04 - немає відповіді від пульта;
        <br/> 0х05 - повернення на основний канал;
        <br/> 0х06 - за командою з ПЦС;
        <br/> 0х07 - помилка пінгу зовнішнього IP;
        <br/> 0х08 - помилка під час введення PIN-коду;
        <br/> 0х09 - проблема з SIM-карткою;
        <br/> 0x0A - погана якість зв'язку;
        <br/> 0x0B - немає зв'язку з WEB-сервером.
        <br/> <b>DAT8</b> - тип каналу з помилкою, формат <b>0xAB</b>:
        <br/> <b>A</b> - фізичний канал: 0 - SIM1, 1 - SIM2, 2 - Ethernet, 3 - WiFi;
        <br/> <b>B</b> - пріоритет каналу (порядок перебору під час спроби передачі):  0 - найвищий (основний), 1 .... 8 - резервні;</td>
    </tr>
    <tr>
      <td>0х0501</td>
      <td>Вхідний дзвінок</td>
      <td>DAT0 ...DAT15</td>
      <td><b> Формат даних: <a href="">DATA_EVENT</a> 
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a> </b>
        <br/> Формат поля DATA - номер абонента, що викликає абонента, який не ідентифікований приладом. Номер у символьному форматі ASCII.</td>
    </tr>
    <tr>
      <td>0х0502</td>
      <td>Змінено конфігурацію системи</td>
      <td></td>
      <td><b> Формат даних: <a href="">DATA_EVENT</a> 
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a> </b>
        <br/> Поле DATA - відсутнє.</td>
    </tr>
    <tr>
      <td>0х0504</td>
      <td>Статус завантаження оновлень</td>
      <td>DAT0</td>
      <td><b> Формат даних: <a href="">DATA_EVENT</a> 
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a> </b>
        <br/> DAT0 - код помилки:
        <br/> 0х00 - немає доступних оновлень;
        <br/> 0х01 - немає зв'язку з WEB-сервером;
        <br/> 0х02 - заборонено адміністратором;
        <br/> 0х03 - завантаження перервано;
        <br/> 0х04 - файл для оновлення пошкоджено;
        <br/> 0х05 - оновлення заборонено - живлення не в нормі;
        <br/> 0х06 - оновлення заборонено - ППК під охороною.
        <br/> 0х07 - оновлення заборонено, причина - повітряна тривога</td>
    </tr>
    <tr>
      <td>0х0505</td>
      <td>Несправність каналу зв'язку</td>
      <td rowspan=2>DAT0</td>
      <td rowspan=2><b> Формат даних: <a href="">DATA_EVENT</a> 
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a> 
        <br/> 0xAB:
        <br/> A</b> - фізичний канал: 0 - SIM1, 1 - SIM2, 2 - Ethernet, 3 - WiFi;
        <br/> <b>B</b> - пріоритет каналу (порядок перебору під час спроби передачі):  0 - найвищий (основний), 1 .... 8 - резервні;</td>
    </tr>
    <tr>
      <td>0х0506</td>
      <td>Відновлення каналу зв'язку</td>
    </tr>
    <tr>
      <td>0х0507..0х051F</td>
      <td>Резерв</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td>0х0520</td>
      <td>Відповідь на USSD запит (0х0A20)</td>
      <td></td>
      <td><b> Формат даних: <a href="">DATA_EVENT</a> 
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a> </b>
        <br/> Формат даних у полях DATA :
        <br/> DAT0 - номер Sim-карти,
        <br/> DAT1...DATN(результат USSD запиту) - рядок у кодуванні ASCII з нульовим закінченням.  </td>
    </tr>
    <tr>
      <td>0х0521</td>
      <td>Кількість помилок по каналах зв'язку</td>
      <td></td>
      <td><b> Формат даних: <a href="">DATA_EVENT</a> 
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a> 
        <br/> Поля DATA:</b>
        <br/> повертає PER(packet error rate) N каналів зв'язку, по 2 байти на кожен, максимальна кількість каналів - 10.
        <br/> Формат запису на канал: <b>0xABEE</b>
        <br/> <b>0xAB</b>- тип каналу, яким передано повідомлення:
        <br/> <b>A</b> - фізичний канал: 0 - SIM1, 1 - SIM2, 2 - Ethernet, 3 - WiFi;
        <br/> <b>B</b> - пріоритет каналу (порядок перебору під час спроби передачі):  0 - найвищий (основний), 1 .... 8 - резервні;
        <br/> <b>0xEE:</b> кількість помилок зі 100 останніх відправлених пакетів.</td>
    </tr>
    <tr>
      <td>0х0522</td>
      <td>Відповідь на запит ідентифікації пристрою (0х0A22).</td>
      <td></td>
      <td><b> Формат даних: <a href="">DATA_EVENT</a> 
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a> </b>
        <br/> Формат даних у полях DATA (результат запиту) - рядок у кодуванні ASCII з нульовим закінченням.  </td>
    </tr>
    <tr>
      <td>0х0523</td>
      <td>Телефонний номер Sim-карти</td>
      <td></td>
      <td><b> Формат даних: <a href="">DATA_EVENT</a> 
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a> </b>
        <br/> Формат даних у полях DATA :
        <br/> DAT0 - номер Sim-карти,
        <br/> DAT1..DATN - телефонний номер, рядок у кодуванні ASCII з нульовим закінченням.  </td>
    </tr>
    <tr>
      <td>0х0524</td>
      <td>Координати приладу</td>
      <td></td>
      <td><b> Формат даних: <a href="">DATA_EVENT</a> 
        <br/> Формат підтвердження: <a href="">EVENT_ACK</a> </b>
        <br/> Формат даних у полях DATA :
        <br/> DAT0 - номер Sim-карти,
        <br/> DAT1..DATN - координати, рядок у кодуванні ASCII з нульовим закінченням.</td>
    </tr>
    <tr>
      <td>0x05F0</td>
      <td>Налаштування ППК (відповідь на команди 0x0AF0 - 0x0AF8)</td>
      <td>DAT0 ...</td>
      <td><b> Формат даних: DEVICE_CFG</b></td>
    </tr>
  </tbody>
</table>


<!-- КОМАНДИ ВІД ПЦС -->
## 3 КОМАНДИ ВІД ПЦС

<!-- STATUS_REQUEST -->
Пакет **STATUS_REQUEST** - запит поточного стану

|Поле|Назва поля|Довжина, байт|Опис|
|---|---|---|---|
|DAT0 ...DAT1|COMMAND|2|COMMAND - код команди від ПЦС, згідно з [Таблицею 2.2.](http)|
|DAT2 ....DAT502|REQ1 ... REQn|0... 500|REQn - запит станів конкретних кіл: <br/> 0х00 - опитати всі; <br/> 0х01 - дані про виріб; <br/> 0х02 - зон; <br/> 0х03 - живлення; <br/> 0х04 - несправності виходів; <br/> 0х05 - вимкнення виходів; <br/> 0х06 - інші несправності (зв'язки, інтерфейси тощо); <br/> 0x07 - інших тривог (тампер, підбір, глушіння тощо) ; <br/> 0x08 - стани зв'язку; <br/> 0x09 - тривоги та несправності безпровідних пристроїв <br/> 0x0A - стан "повітряна тривога"|

*Примітка.*
1. *Відповіді на запити - згідно з [Таблицею 2.2.](http)*

2. *Після запиту STATUS_REQUEST прилад повертає підтвердження COMMAND_ACK, потім по черзі формує пакети подій, відповідно до переданих запитів REQn:  
0х01 - дані про виріб, наявність оновлень та їхня версія 0х0308 (пакет DATA_EVENT);  
0х02 - на статус зон, подія 0х0302 (пакет ZONE_STATUS) або  ZONE_SENSORS_STATE ;  
0х03 - несправності електроживлення, подія 0х0101 (пакет CIRCUIT_EVENT);  
0х04 - несправності виходів 0х0103 (пакет CIRCUIT_EVENT);*
0х05 - вимкнені кола 0х0202 (пакет USER_EVENT), без зазначення номера користувача;  
0х06 - інші несправності 0х0105 (пакет CIRCUIT_EVENT);  
0х07 - інші тривоги 0х0036 (пакет CIRCUIT_EVENT);  
0x09 - тривоги та несправності безпровідних пристроїв (пакет WRL_DEVICES_ALARM_STATE);  
0x0A - стан "повітряна тривога" пакет ALERT_EVENT);  
0х00 - усі перелічені вище.
3. *Формат підтвердження про приймання від ППК - [COMMAND_ACK](http)*  
4. *Якщо запитані події в приладі відсутні (наприклад немає несправних виходів), то прилад у відповідь на запит формує порожній пакет відповідного типу (наприклад 0х0103 без даних).*
   
<br/>

<!-- REMOTE_COMMAND -->
Пакет **REMOTE_COMMAND** - команда для ППК від оператора пульта

|Поле|Назва поля|Довжина, байт|Опис|
|---|---|---|---|
|DAT0 ...DAT1|COMMAND|2|COMMAND - код команди від ПЦС, згідно з [Таблицею 2.2.](http)|
|DAT2 ...DATn|DATA1 ...DATAn|0 ... 496|DATAх - дані у форматі, згідно з [Таблицею 2.2.](http) <br/> Максимальна кількість полів DATAх в одному пакеті - 496.|

*Примітка. Залежно від поля COMMAND поля даних DATAх можуть бути відсутніми.*
   
<br/>

<!-- COMMAND_ACK -->
Підтвердження **COMMAND_ACK** на отримання команди від ПЦС.

|Поле|Назва поля|Довжина, байт|Опис|
|---|---|---|---|
|DAT0 ...DAT1|COMMAND|2|COMMAND - код команди від ПЦС, з пакета запиту (COMMAND SEND, STATUS REQUEST)|
|DAT2 ...DAT3|STATUS|2|STATUS - статус виконання команди: <br/> 0х00 - команду прийнято; <br/> 0х01 - команда не підтримується; <br/> 0х02 - команда не може бути виконана зараз.|
   
<br/>

<!-- READ_ACK -->
Підтвердження **READ_ACK** - запитані дані з ППК.

|Поле|Назва поля|Довжина, байт|Опис|
|---|---|---|---|
|DAT0 ...DAT1|COMMAND|2|COMMAND - код команди від ПЦС, з пакета запиту (COMMAND SEND, STATUS REQUEST)|
|DAT2 ...DAT3|STATUS|2|STATUS - статус виконання команди: <br/>0х00 - команду виконано; <br/>0х01 - команда не підтримується; <br/>0х02 - команда не може бути виконана зараз.|
|DAT2 ...DATn|DATA1 ...DATAn|1 ...496|DATAх - дані у форматі, згідно з [Таблицею 2.2.](http) <br/> Максимальна кількість полів DATAх в одному пакеті - 496.| 

<br/>

<!-- COMMAND_CFG -->
Пакет **COMMAND_CFG** - команда запиту налаштувань

|Призначення поля|Розмір, байт|Значення|
|---|---|---|
|COMM_CODE|2|Код команди згідно з [Таблицею 2.2.](http)|
|PARAM_SIZE|1|Розмір одного елемента масиву PARAM, байт: 0...237|
|PARAM [0] <br/> ... <br/> PARAM [n]|PARAM_SIZE|Опис параметрів наведено нижче.|

*Примітка.*
1. *Підтвердження від приладу у форматі - [COMMAND_ACK](http)*
2. *Кількість полів PARAM залежить від команди, але не має перевищувати 237 байт.*

<br/>

<!-- Параметри команд запиту налаштувань. -->
Параметри команд запиту налаштувань.

|Опція|Код команди COMM_CODE|Параметри PARAM[n]|Примітка|
|---|---|---|---|
|GET_CONFIG (видати поточні налаштування)|
|Налаштування користувача <br/> Налаштування зон <br/> Налаштування груп| <br/> 0x0AF1 <br/> 0x0AF2 <br/> 0x0AF3| <br/> Param[0] ... Param[n]: <br/> USER #1 ... USER # n+1 <br/> Param[0] ... Param[n]: <br/> ZONE #1 ... ZONE # n+1 <br/> Param[0] ... Param[n]: <br/> GRUPE #1 ... GRUPE # n+1|**PARAM_SIZE = 1.** <br/> Буде передано конфігурацію запитаних параметрів. <br/> Якщо Param[0] = 0, приладом видається конфігурація всіх параметрів цього типу, **пов'язаних із сервером**|
|Налаштування модулів|0x0AF6|Param[0] ... Param[n]:<br/> EXT #1 ... EXT # n+1|**PARAM_SIZE = 1.** <br/> Буде передано конфігурацію запитаних параметрів. <br/> Якщо Param[0] = 0, приладом видається конфігурація всіх модулів|
|Системні налаштування|0x0AF7|0|**PARAM_SIZE = 0.** <br/>приладом видаються всі системні налаштування|
|Налаштування бездротових пристроїв|0x0AF8|Param[0] ... Param[n]:<br/>WRL_D#1...WRL_D# n+1|**PARAM_SIZE = 1.**<br/>приладом видається конфігурація запитаних параметрів. Якщо Param[0]= 0, прилад видає конфігурацію всіх бездротових пристроїв|

<br/>

<!-- Таблиця 2.2 - Типи команд -->

**Таблиця 2.2** - Типи команд

<table style="width: 100%">
  <thead>
    <tr>
      <th colspan=2>Значення поля COMMAND</th>
      <th>Опис відповіді</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Код (hex)</td>
      <td>Передача даних</td>
      <td></td>
    </tr>
    <tr>
      <td>0х0A00</td>
      <td>Опитування стану</td>
      <td><b> Формат даних: <a href="">STATUS_REQUEST</a>
       <br/> Формат підтвердження: <a href="">COMMAND_ACK<</a>/b>
       <br/> Дані: немає.</td>
    </tr>
    <tr>
      <td>0х0A01</td>
      <td>Постановка зон під охорону</td>
      <td rowspan=4><b>Формат даних: <a href="">REMOTE_COMMAND</a>
       <br/> Формат підтвердження: <a href="">COMMAND_ACK</a> </b>
       <br/> Формат даних у полях DATA: записи довжиною по 4 байти, де
       <br/> 0х00BBZZZZZZ, де:
       <br/> <b>BB</b> (0x00...0xFF) - номер блоку в приладі; 0х00 - якщо поле не використовується.
       <br/> <b>ZZZZZ</b> (0x0001...0xFFFF) - порядковий номер зони (шлейфу) в блоці або системі.</td>
    </tr>
    <tr>
      <td>0х0A02</td>
      <td>Зняття зон з охорони</td>
    </tr>
    <tr>
      <td>0х0A03</td>
      <td>Перевстановлення під охорону</td>
    </tr>
    <tr>
      <td>0х0A04</td>
      <td>Скидання параметричних зон</td>
    </tr>
    <tr>
      <td>0х0A05</td>
      <td>Активувати стан "Повітряна тривога"</td>
      <td rowspan=2><b>Формат даних: <a href="">REMOTE_COMMAND</a>
       <br/> Формат підтвердження: <a href="">COMMAND_ACK</a> </b>
       <br/> Формат даних у полях DATA:
       <br/> DATA1...DATA4</b> - час формування стану у форматі UNIXTIME</td>
    </tr>
    <tr>
      <td>0х0A06</td>
      <td>Деактивувати стан "Повітряна тривога"/td>
    </tr>
    <tr>
      <td>0х0A07</td>
      <td>Увімкнути активність КНС у налаштуваннях</td>
      <td rowspan=2><b>Формат даних: <a href="">REMOTE_COMMAND</a>
       <br/> Формат підтвердження: <a href="">COMMAND_ACK</a> </b>
       <br/> Формат даних у полях DATA:
       <br/> DATA1...DATAn</b> - перелік номерів Графіків КНС (по одному байту на номер)</td>
    </tr>
    <tr>
      <td>0х0A08</td>
      <td>Вимкнути активність КНС у налаштуваннях/td>
    </tr>
    <tr>
      <td>0х0A10</td>
      <td>Активувати вихід</td>
      <td rowspan=2><b>Формат даних: <a href="">REMOTE_COMMAND</a>
       <br/> Формат підтвердження: <a href="">COMMAND_ACK</a> </b>
       <br/> Формат даних у полях DATA: записи довжиною по 4 байти, де 0х00BBССNN:
       <br/> BB</b> (0x00...0xFF) - номер блоку в приладі;
       <br/> <b>CC</b> (0x00...0xFF) - коло:
       <br/> <b>0х00</b> - вихід без контролю;
       <br/> <b>0х01</b> - вихід із контролем;
       <br/> <b>0х02</b> - оповіщувач.
       <br/> <b>NN</b> - номер кола за порядком, 0х00 - номер кола не визначено.</td>
    </tr>
    <tr>
      <td>0х0A11</td>
      <td>Зробити вихід неактивним/td>
    </tr>
    <tr>
      <td>0х0A12</td>
      <td>Читання налаштувань приладу</td>
      <td><b>Формат даних: <a href="">REMOTE_COMMAND</a>
       <br/> Формат підтвердження: <a href="">READ_ACK</a> </b>
       <br/> Формат даних у полях DATA <a href="">READ_ACK</a>:</b> записи довільної довжини у вигляді набору символів, у кодуванні ASCII.  
<b>DATA1 ... DATAn</b> (до 492 байт) - запитані дані.
      <br/> <b><u>Дескриптори</u></b>
      <br/> Існує два види дискрипторів: ключові та залежні. Усі дискриптори, які зустрічаються між ключовими, належать до першого ключового. Ключові дискриптори розділені крапкою з комою, не ключові - комою.
      <br/> Наприклад, у рядку налаштувань нижче ключові дискриптори CH і IP1, тобто всі дискриптори та їхні параметри після "CH" і до ";" належать до "SIM1", від "IP1" і до ";" до IP1.
      <br/> Рядок налаштувань, наприклад:
      <br/> <b>“CH:SIM1,AP:internet,PIN:1234; IP1:093.183.195.169@3008;”</b>
      <br/> Ключові дискриптори:
      <br/> <b>CH</b> - канал.
      <br/> Параметри: <b>SIM1, SIM2, ETH, WIFI.</b>
      <br/> Залежні дискриптори: <b>AP, PIN, ACT, CHID.</b>
      <br/> <b>IP1... IP4</b> - IP-адреса та порт призначення.
      <br/> Параметри: <b>ххх.ххх.ххх.ххх.ххх.ххх@xxxxx</b> або <a href="">0@0</a> 
      <br/> <b>TEST_PRIM</b> - час тесту основного каналу.
      <br/> Параметри: час у секундах
      <br/> <b>TEST_ALT</b> - час тесту резервних каналів каналів.
      <br/> Параметри: час у секундах
      <br/> Залежні дискриптори:
      <br/> <b>ACT</b> - канал використовується чи ні;
      <br/> Параметри: <b>ON, OFF</b>
      <br/> <b>AP</b> - точка доступу,
      <br/> Параметри: точка доступу рядком ASCII до 32 символів.
      <br/> <b>CHID</b> - ідентифікатор каналу (для GSM, типу Кyivstar або UMC), тільки читання.
      <br/> Параметри: ідентифікатор рядком ASCII до 32 символів.
      <br/> <b>GATE</b> - IP-адреса шлюзу, <b>MAC</b> - MAC-адреса приладу, IPS - IP-адреса приладу, <b>MASK</b> - маска під мережі, <b>DNS</b> - доменне ім'я сервера, <b>DHCP</b> - функція автоматичного отримання IP-адреси.
      <br/> <b><u>Параметри</b></u>
      <br/> Якщо налаштування має кілька параметрів, їх можна розділити символом "@", наприклад: <b>парам1@парам2.</b>
      <br/> <b><u>Запити налаштувань</b></u>
      <br/> <i>Запити налаштувань здійснюються заповненням</i> поля DATA в команді <a href="">REMOTE_COMMAND</a> відповідним ключовим дискриптором.
      <br/> <b><u>Приклади</b></u>
      <br/> <i>Дискриптор "СН" без параметрів - запит типів каналів ППК.
      <br/> Відповідь:</i> "CH: SIM1, ACT:ON; CH:SIM2, ACT:OFF, ETH:ON"
      <br/> <i>Запит налаштувань каналу SIM2: "CH:SIM2"
      <br/> Відповідь:</i> "CH:SIM2,AP: internet,CHID: Life)"</td>
    </tr>
    <tr>
      <td>0х0A13</td>
      <td>Запис налаштувань у прилад</td>
      <td><b>Формат даних: <a href="">REMOTE_COMMAND</a>
       <br/> Формат підтвердження: <a href="">COMMAND_ACK</a> </b>
       <br/> </b>Формат даних у полях DATA <a href="">REMOTE_COMMAND</a>: </b>записи довільної довжини у вигляді набору символів, у кодуванні ASCII.  
       <br/> <b>DATA1 ... DATAn</b> (до 492 байт) - дані для запису.
       <br/> <b>Дескриптори: див. "<i>Читання налаштувань приладу</i>"
       <br/> Параметри: див. <i>Параметри</i> в "Читання налаштувань приладу"
       <br/> <u>Приклади</b></u>
       <br/> <i>Запис налаштувань каналу SIM2:</i>
       <br/> "CH:SIM1,AP: internet,PIN:1234;"
       <br/> <i>Встановити другу точку доступу для SIM2:</i>
       <br/> "CH: SIM2,AP: internet"
       <br/> <i>Встановити IP-адреси 1 і 2 (з портами пульта), 3 і 4 - стерти:</i>
       <br/> IP1:093.183.195.169@3008;
       <br/> IP2:093.183.195.169@3008;
       <br/> IP3:0@0; IP4:0@0;
       <br/> <i>Відключити SIM2:</i>
       <br/> "CH: SIM2, ACT:OFF"
       <br/> <i>Змінити час тесту (налаштувати 60 секунд для основного каналу і 900 секунд для резервних):</i>
       <br/> "TEST_PRIM:60,TEST_ALT:900;"</td>
    </tr>
    <tr>
      <td>0х0A14</td>
      <td>Читання журналу</td>
      <td><b>Формат даних: <a href="">REMOTE_COMMAND</a>
       <br/> Формат підтвердження: <a href="">READ_ACK</a> </b>
       <br/> </b>Формат даних у полях DATA <a href="">REMOTE_COMMAND</a>: </b>
       <br/> <u>Запит 1: за інтервалом часу</u>
       <br/> <b>StartTime:EndTime</b> - час у форматі UNIXTIME.
       <br/> StartTime (DATA1 ... DATA4) - час першого повідомлення для читання,
       <br/> EndTime (DATA5 ... DATA8) - час останнього повідомлення для читання.
       <br/> <u>Запит 2: за період (у годинах)</u>
       <br/> StartTime = 1 - усі повідомлення за останню годину;
       <br/> StartTime = 24 - усі повідомлення за останню добу.
       <br/> <b>Формат даних відповіді в полях DATA <a href="">READ_ACK</a>:</b>
       <br/> (повертає n записів журналу розміром по 10 байт, максимальна кількість записів - 496/10 = 49). Залежно від EE формат запису:
       <br/> <b>TTTTT EE GG UU</b> або
       <br/> <b>TTTTT EE ZZZ AA</b> де:
       <br/> <b>TTTTT</b> - час у форматі UNIXTIME (4 байти); EE - код події; GG - номер групи; UU - номер користувача; ZZZ - номер зони; AA - адреса компонента (по 2 байти всі поля, крім ТТТТ).</td>
    </tr>
    <tr>
      <td>0х0A15</td>
      <td>Увімкнути службову інформацію</td>
      <td rowspan=2><b>Формат даних: <a href="">REMOTE_COMMAND</a>
       <br/> Формат підтвердження: <a href="">COMMAND_ACK</a> </b>
       <br/>Дані: немає.</td>
    </tr>
  </tbody>
</table>

















































































































































































































































































<!-- -----------------------Посилання----------------------- -->
[EVENT_ACK]: https